define("confluence/view-my-drafts",["jquery","ajs","backbone","confluence/templates"],function(d,c,e,f){return e.View.extend({events:{"click .view-legacy-draft":"open"},initialize:function(){this.$el.append(f.LegacyDrafts.render());var a=c.dialog2("#legacy-draft-dialog");this.model.set({dialog:a});var b=this;a.$el.find(".close").on("click",function(){a.hide()});a.on("hide",function(){b.close(b)})},render:function(){var a=this.model.get("dialog");a.$el.find(".aui-dialog2-header-main").html(this.model.get("title"));
a.$el.find(".aui-dialog2-content").html(this.model.get("content"))},open:function(a){a.preventDefault();c.trigger("analytics",{name:"confluence.viewsource.resume.legacy.draft"});var b=this,e=d(a.target).data("draftid"),f=d(a.target).data("drafttitle"),a=this.model.getPage(e);a.done(function(a){b.model.get("dialog").show();b.model.set({title:f,content:a});b.render();d("body").addClass("no-select")});a.fail(function(){b.model.get("dialog").show();b.model.set({title:c.I18n.getText("view.draft.error"),
content:""})})},close:function(a){a.model.set({title:"",content:""});d("body").removeClass("no-select")}})});require("confluence/module-exporter").safeRequire("confluence/view-my-drafts",function(d){var c=require("ajs"),e=require("backbone"),f=require("jquery"),a=new e.Model;a.getPage=function(a){return c.safe.ajax({type:"GET",url:c.contextPath()+"/plugins/viewsource/viewpagesrc.action",data:{pageId:a}})};c.toInit(function(){new d({el:f(".view-my-drafts"),model:a})})});