define("confluence/autocomplete-content",["jquery","document","ajs"],function(b,d,i){var p=function(a){if(!a||!a.group)throw Error("Invalid JSON format");for(var g=[],b=0,d=a.group.length;b<d;b++)g.push(a.group[b].result);return g},e=function(a,g,d,e){var c=b(a);if(!c.attr("data-autocomplete-content-bound")){"string"===typeof g&&(g=[g]);c.attr("data-autocomplete-content-bound","true").attr("autocomplete","off");var f=g.join(","),h=c.attr("data-max")||10,a=c.attr("data-alignment")||"left",k=c.attr("data-spacekey"),
l=c.attr("data-none-message"),m=c.attr("data-search-link-message"),q=c.attr("data-template")||d,n=c.attr("data-target"),o=c.attr("data-dropdown-target"),j=null;o?j=b(o):(j=b("<div></div>"),c.after(j));j.addClass("aui-dd-parent autocomplete");c.focus(function(){k=c.attr("data-spacekey")});c.quicksearch(i.REST.getBaseUrl()+"search/name.json",null,{onShow:function(){c.trigger("open.autocomplete-content",{contentTypes:g})},makeParams:function(a){a={"max-results":h,pageSize:h,type:f,query:a};if(k)a.spaceKey=
k;return a},dropdownPlacement:function(a){j.append(a)},makeRestMatrixFromData:p,addDropdownData:function(a){a.length||l&&a.push([{name:l,className:"no-results",href:"#"}]);if(m){var b=i.escapeHtml(c.val()),b=i.format(m,b);a.push([{className:"search-for",name:b,href:"#"}])}return a},ajsDropDownOptions:{alignment:a,displayHandler:e,selectionHandler:function(a,e){i.debug("autocomplete-content: ajsDropDownOptions.selectionHandler");if(e.find(".search-for").length)c.trigger("selected.autocomplete-content",
{contentTypes:g,searchFor:c.val()});else{if(e.find(".no-results").length)i.debug("no results selected");else{var f=e.data("properties");c.val(i.template(q).fillHtml(f.restObj));if(n){var h=i.template(d).fillHtml(f.restObj);b(n).val(h)}c.trigger("selected.autocomplete-content",{contentTypes:g,content:f.restObj,selection:e})}this.hide();a.preventDefault()}}}})}},f={autocompleteSpace:function(a){a=a||d.body;b("input.autocomplete-space",a).each(function(){e(this,["spacedesc","personalspacedesc"],"{name}",
function(a){return a.name})})},autocompleteAttachment:function(a){a=a||d.body;b("input.autocomplete-attachment",a).each(function(){e(this,"attachment","{fileName}",function(a){var b=a.restObj&&a.restObj.fileName||a.name;a.restObj&&(a.restObj.space&&a.restObj.space.title)&&(b+=" ("+a.restObj.space.title+")");return b})})}},h=function(a){return a.restObj&&a.restObj.title&&i.escapeHtml(a.restObj.title)||a.name};f.autocompletePage=function(a){a=a||d.body;b("input.autocomplete-page",a).each(function(){e(this,
"page","{title}",h)})};f.autocompleteBlogpost=function(a){a=a||d.body;b("input.autocomplete-blogpost",a).each(function(){e(this,"blogpost","{title}",h)})};f.autocompleteConfluenceContent=function(a){a=a||d.body;b("input.autocomplete-confluence-content",a).each(function(){e(this,["page","blogpost"],"{title}",h)})};f.autocompleteSearch=function(a){a=a||d.body;b("input.autocomplete-search",a).each(function(){e(this,[],"{title}",h)})};return f});
require("confluence/module-exporter").safeRequire("confluence/autocomplete-content",function(b){var d=require("confluence/legacy");d.Binder.autocompleteSpace=b.autocompleteSpace;d.Binder.autocompleteAttachment=b.autocompleteAttachment;d.Binder.autocompletePage=b.autocompletePage;d.Binder.autocompleteBlogpost=b.autocompleteBlogpost;d.Binder.autocompleteConfluenceContent=b.autocompleteConfluenceContent;d.Binder.autocompleteSearch=b.autocompleteSearch});