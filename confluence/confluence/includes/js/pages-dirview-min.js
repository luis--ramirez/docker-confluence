define("confluence/pages-dirview",["ajs","jquery","confluence/meta","confluence/api/constants"],function(a,c,h,d){var g=function(b){var e="";b.actionErrors&&b.actionErrors.length&&(e=b.actionErrors.join("<br>"),a.log("ajax parameters invalid : "+e));c("#resultsDiv").html(e)};return function(){var b=c("#tree-div").tree({url:d.CONTEXT_PATH+"/pages/children.action",initUrl:d.CONTEXT_PATH+"/pages/children.action?spaceKey="+encodeURIComponent(h.get("space-key"))+"&node=root",parameters:["pageId"],nodeId:"pageId",
drop:function(){c(this.source).addClass("flash");var e=this.source.pageId,b=this.target.pageId,f=this.position;a.trigger("analytics",{name:"confluence.page.hierarchy.reorder",data:{}});a.safe.getJSON(d.CONTEXT_PATH+"/pages/movepage.action",{pageId:e,position:f,targetId:b},g)},order:function(){c.getJSON(d.CONTEXT_PATH+"/pages/revertpageorder.action",{pageId:this.source.pageId},g)},orderUndo:function(){var a=this.source.pageId,b=c.map(this.orderedChildren,function(a){return a.pageId}).join();c.getJSON(d.CONTEXT_PATH+
"/pages/setpageorder.action",{pageId:a,orderedChildIds:b},g)},onready:function(){a.params.expandedNodes||(a.params.expandedNodes=[]);if(a.params.openId)var e=function(){b.findNodeBy("pageId",a.params.openId).highlight()};for(var c=[],f=0,d=a.params.expandedNodes.length;f<d;f++)c[f]={pageId:a.params.expandedNodes[f]};b.expandPath(c.reverse(),e)}})}});require("confluence/module-exporter").safeRequire("confluence/pages-dirview",function(a){require("ajs").toInit(a)});