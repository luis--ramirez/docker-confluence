define("confluence/dialog",["ajs","document","jquery"],function(a,h,d){return{component:function(b){var g,b=b||{},b=d.extend({},{keypressListener:function(c){if(27===c.keyCode){if(a.debug("dialog.js: escape keydown caught"),!d(".aui-dropdown",g.popup.element).is(":visible"))if("function"===typeof b.onCancel)b.onCancel();else g.hide()}else 13===c.keyCode&&(a.debug("dialog.js: enter keydown caught"),d(".aui-dropdown",g.popup.element).is(":visible")||"textarea"!=(c.target.nodeName&&c.target.nodeName.toLowerCase())&&
"function"==typeof b.onSubmit&&setTimeout(b.onSubmit))},width:865,height:530},b);g=new a.Dialog(b);d(h).bind("hideLayer",function(a,e,f){if("popup"==e&&f==g&&"function"===typeof b.onCancel)b.onCancel()});return g},initialiser:function(b){a.bind("show.dialog",function(b,c){var e=a.Meta.get("page-id"),f=a.Meta.get("space-key"),i=a.Meta.get("editor-mode"),d=a.Meta.get("new-page");a.EventQueue=a.EventQueue||[];a.EventQueue.push({name:c.dialog.id,properties:function(){var b={};e&&(b.pageid=e);f&&(b.spacekey=
f);i&&(b.editormode=i);d&&(b.newpage=d);return b}()})});b(h).bind("showLayer",function(a,c,e){Confluence.runBinderComponents();if("popup"==c&&e){var a=b(e.element),f;if(!a.attr("data-lasttab-override")){a.attr("data-tab-default")&&(f=a.attr("data-tab-default"));var d=Confluence.storageManager(a.attr("id")),c=d.getItem("last-tab");(f=null!=c?c:f)&&b(".page-menu-item:visible:eq("+f+") button",a).click();a.attr("data-lasttab-bound")||(b(".page-menu-item",a).each(function(a,c){b(c).click(function(){d.setItem("last-tab",
a)})}),a.attr("data-lasttab-bound","true"))}}});a.Dialog.prototype.overrideLastTab=function(){b(this.popup.element).attr("data-lasttab-override","true")};a.Dialog.prototype.addHelpText=function(d,c){if(d){var e=d;c&&(e=a.template(d).fill(c).toString());var f=this.page[this.curpage];f.buttonpanel||f.addButtonPanel();e=b("<div class='dialog-tip'></div>").html(e);f.buttonpanel.append(e);b("a",e).click(function(){window.open(this.href,"_blank").focus();return!1})}};a.Dialog.prototype.getTitle=function(){return b("#"+
this.id+" .dialog-components:visible h2").text()};a.Dialog.prototype.isVisible=function(){return b("#"+this.id).is(":visible")}}}});require("confluence/module-exporter").safeRequire("confluence/dialog",function(a){AJS.ConfluenceDialog=a.component;AJS.toInit(a.initialiser)});