define("confluence/linkpage",["ajs","jquery","confluence/legacy"],function(a,g,e){return function(b){if(b("link[rel=canonical]").length){var c=null;b("#link-to-page-link").click(function(f){if(!c){c=(new a.Dialog(600,210,"link-page-popup")).addHeader(a.I18n.getText("dialog.linktothispage.heading")).addPanel(a.I18n.getText("dialog.linktothispage.heading"),"<form id='link-page-popup-form' class='aui'><fieldset></fieldset></form>").addCancel(a.I18n.getText("close.name"),function(){c.hide();return!1});
e.KeyboardShortcuts&&e.KeyboardShortcuts.enabled&&c.addHelpText(a.I18n.getText("keyboard.shortcuts.dialog.tip","k"));var d=[{label:a.I18n.getText("insert.link.popup.destination"),id:"link",value:b("link[rel=canonical]").attr("href")},{label:a.I18n.getText("tiny.link"),id:"tiny-link",value:b("link[rel=shortlink]").attr("href")}];b.each(d,function(){b("#link-page-popup-form fieldset").append(a.format("<div class='field-group'><label for=''link-popup-field-{0}''>{1}:</label><input id=''link-popup-field-{0}'' readonly=''readonly'' value='''' class=''text'' type=''text''></div>",
this.id,this.label)).find("input:last").val(this.value)});d=b("#link-page-popup-form fieldset input.text");d.focus(function(){b(this).select()});d.mouseup(function(a){a.preventDefault()})}f.preventDefault();c.show();b("#link-page-popup-form #link-popup-field-tiny-link").select()})}}});require("confluence/module-exporter").safeRequire("confluence/linkpage",function(a){require("ajs").toInit(a)});